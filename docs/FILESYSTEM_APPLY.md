# Filesystem Apply: Guarded, Repo-Scoped

## fileOps intent format
```json
{
  "fileOps": [
    { "type": "create" | "modify" | "delete", "path": "relative/path", "diff": "unified diff OR full content" }
  ]
}
```
- Intent only; generated by LLM, never auto-executed.
- Stored per execution as proposals.

## Review UI behavior
- Proposals appear in the Git/Review pane: path, type, diff/content.
- User can Apply or Reject explicitly.
- Proposals persist until acted on; no background actions.

## Apply vs Reject semantics
- **Apply**: Renderer calls `window.ghostflow.applyFileOps(repoPath, fileOps)` (preload API).
- **Reject**: Marks proposals rejected; no filesystem changes.
- Apply never triggers new LLM calls; it is purely deterministic execution of the proposal.

## Deterministic file writes
- Path validation: no absolute paths, no `..` traversal; must resolve under the connected repo root.
- Operations:
  - create: write content
  - modify: apply unified diff if present; otherwise treat `diff` as full content
  - delete: remove file if exists
- Errors surface explicitly; Apply fails fast if validation or patching fails.

## Error surfacing
- Invalid paths or missing repo path → explicit error, no writes.
- Patch failures → explicit error, proposal marked error.
- No silent fallback to mock or background retries.

## What this is NOT
- No autonomous editing; human approval required.
- No shell execution or external tooling.
- No writes outside the active repo root.
